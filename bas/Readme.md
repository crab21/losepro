
## 办公室自动化控制系统

### 灯控命令

* 灯网络协议报文

        55BB0A0400004005430EE157CB0011002503B9000003FF79A5140000000000000000000000000000000000000000000000000000000000000000
        55BB // 上报协议
        0A // 0A: 51; 1A: ARM
        04000040 // 段号地址号
        0543 // 帧编号
        0E // 有效数据长度
        E1 // COMMAND WORD
        57CB0011002503B9000003FF79A5 // 信息
        57CB 0011 0025 03B9 // 电压、电流、功率、功率因数
        00 00 03 FF //
        79A5 // 帧编号
        140000000000000000000000000000000000000000000000000000000000000000

* 群发命令：

        55AA0A FF000000 0001 07 F1 05 04000090 85 00 0E
        55AA0A FF000000 // prefix
        0001 // frame number
        07(05 04000090 85 00) //
        F1 // 群发
        05(05 04000090) // 段号地址号+1
        04000090 // 段号地址号
        85 // 命令字 
        00 // 信息正文
        0E // 校验字（后两位）
        
        单灯命令：
        55AA0A 04000090 XXXX 01 85 00 XX

### 灯网络分组信息

    // 财务室
    var financeOffice = '350-646-647-648';
    // 技术办公室
    var technologyOffice = '644-645';
    // 总经理办公室
    var leaderOffice = '343-611-612-613-614-615';
    // 实验室
    var laboratory = '340-341-342-600-601-602-603-604-605-606-607-608-609-610';
    // 前台-接待室
    var reception = '347-633-634-635-636';
    // 会议室
    var conference = '348-349-637-638-639-640-641-642-643';
    // 餐厅
    var restaurant = '354-665-666-667-669-670-671-672';
    // 大厅
    var hall = '344-345-346-351-352-353-355-616-617-618-619-620-621-622-623-624-625-626-627-628-629-630-631-632-659-660-661-662-668-655-656-657-658-663-664-654-653-652-651-650-649';
    // 靠窗
    var window = '649-650-651-351-652-653-654';
    // 大厅北
    var hall_north = '655-656-352-657-658-663-664-659-660-353-661-662-668-355';
    // 大厅南
    var hall_south = '628-629-630-346-631-632-622-623-624-625-345-626-627-616-617-618-344-619-620-621';
    // 照明控制
    var all = '647-648-649-650-651-351-652-653-654-646-350-655-656-352-657-658-663-664-354-665-666-667-644-645-659-660-353-661-662-668-355-669-670-671-672-628-629-630-346-631-632-641-642-643-613-614-615-622-623-624-625-345-626-627-639-349-640-612-611-343-616-617-618-344-619-620-621-348-637-638-604-603-341-340-600-601-602-347-605-606-607-342-608-609-610-633-634-635-636';
    
    
### 空调地址
    
    801-802-803-804-805-806-807-808-809-810-811-812-813-814-815-816-817-818-819-820
    
* 空调协议

        空调协议
        通讯界面：  RS485   温控器作为从机，等待主机的扫描
        通信规格：  2400波特率、8个数据位、一个停止位、一个起始位
        目前的封包协议如下
        COMMAND + ID0 + ID1 + Data0 + Data1 + Data2 + Data3 + CheckSum
        总共 8 Bytes
        CheckSum = (COMMAND + ID0 + ID1 + Data0 + Data1 + Data2 + Data3) & 0xFF ^ 0xA5
        温控器默认地址为 1033
        一、读空调
        1、	指令
        	COMMAND：0XA0        向温控器读数据
        	IDL                      温控器地址低
        	IDH                      温控器地址低
        	Data0：0X0
        	Data1：0X0
        	Data2：0X0
        	Data3：0X0
        	CheckSum= (COMMAND + ID0 + ID1 + Data0 + Data1 + Data2 + Data3) & 0xFF ^ 0xA5
        2、	应答数据包顺序
        	COMMAND：00X50
        	IDL
        	IDH
        	DATA0：空调状态
        	DATA1：补温度
        	DATA2：设定温度
        	DATA3：室温
        	CheckSum = (COMMAND + ID0 + ID1 + Data0 + Data1 + Data2 + Data3) & 0xFF ^ 0xA5
        3、	空调状态码
        D7	D6	D5	D4	D3	D2	D1	D0
        备用	备用	模式	开关机	备用	备用	风速
                0	0			0	0
                制冷	关机			自动
                1	1			0	1
                制热	开机			高速
                                1	0
                                中速
                                1	1
                                低速
        
        二、写空调
        1、	指令
        	COMMAND：0XA1       向温控器写数据
        	IDL
        	IDH
        	Data0：空调控制码（与空调状态码定义相同）
        	Data1：补温度
        	Data2：设定温度
        	Data3：0X0
        	CheckSum= (COMMAND + ID0 + ID1 + Data0 + Data1 + Data2 + Data3) & 0xFF ^ 0xA5
        2、	应答数据包顺序
        	COMMAND：00X51
        	IDL
        	IDH
        	DATA0：空调状态
        	DATA1：补温度
        	DATA2：设定温度
        	DATA3：室温
        	CheckSum = (COMMAND + ID0 + ID1 + Data0 + Data1 + Data2 + Data3) & 0xFF ^ 0xA5
